Drupal.Views={};Drupal.behaviors.viewsTabs=function(context){$('#views-tabset:not(.views-processed)').addClass('views-processed').each(function(){new Drupal.Views.Tabs($(this),{selectedClass:'active'})});$('a.views-remove-link').addClass('views-processed').click(function(){var id=$(this).attr('id').replace('views-remove-link-','');$('#views-row-'+id).hide();$('#views-removed-'+id).attr('checked',true);return false})};Drupal.behaviors.viewsHoverlinks=function(){if($.browser.msie){$("div.view:not(.views-hover-processed)").addClass('views-hover-processed').hover(function(){$('div.views-hide',this).addClass("views-hide-hover");return true},function(){$('div.views-hide',this).removeClass("views-hide-hover");return true});$("div.views-admin-links:not(.views-hover-processed)").addClass('views-hover-processed').hover(function(){$(this).addClass("views-admin-links-hover");return true},function(){$(this).removeClass("views-admin-links-hover");return true})}};Drupal.Views.parseQueryString=function(query){var args={},pos=query.indexOf('?');if(pos!=-1)query=query.substring(pos+1);var pairs=query.split('&');for(var i in pairs)if(typeof(pairs[i])=='string'){var pair=pairs[i].split('=');if(pair[0]!='q'&&pair[1])args[pair[0]]=decodeURIComponent(pair[1].replace(/\+/g,' '))};return args};Drupal.Views.parseViewArgs=function(href,viewPath){var returnObj={},path=Drupal.Views.getPath(href);if(viewPath&&path.substring(0,viewPath.length+1)==viewPath+'/'){var args=decodeURIComponent(path.substring(viewPath.length+1,path.length));returnObj.view_args=args;returnObj.view_path=path};return returnObj};Drupal.Views.pathPortion=function(href){var protocol=window.location.protocol;if(href.substring(0,protocol.length)==protocol)href=href.substring(href.indexOf('/',protocol.length+2));return href};Drupal.Views.getPath=function(href){href=Drupal.Views.pathPortion(href);href=href.substring(Drupal.settings.basePath.length,href.length);if(href.substring(0,3)=='?q=')href=href.substring(3,href.length);var chars=['#','?','&'];for(i in chars)if(href.indexOf(chars[i])>-1)href=href.substr(0,href.indexOf(chars[i]));return href};
Drupal.Views=Drupal.Views||{};Drupal.Views.Tabs=function(el,options){this.source=el;this.options=$.extend({initial:0,event:'click',disabled:[],unselected:false,toggle:options.unselected?true:false,spinner:'Loading&#8230;',cache:false,hashPrefix:'tab-',fxSpeed:'normal',add:function(){},remove:function(){},enable:function(){},disable:function(){},click:function(){},hide:function(){},show:function(){},load:function(){},navClass:'ui-tabs-nav',selectedClass:'ui-tabs-selected',disabledClass:'ui-tabs-disabled',containerClass:'ui-tabs-container',hideClass:'ui-tabs-hide',loadingClass:'ui-tabs-loading'},options);this.tabify(true);var uuid='instance-'+ Drupal.Views.Tabs.prototype.count++;Drupal.Views.Tabs.instances[uuid]=this;this.source.data('UI_TABS_UUID',uuid)};Drupal.Views.Tabs.instances={};$.extend(Drupal.Views.Tabs.prototype,{animating:false,count:0,tabify:function(init){this.$tabs=$('a:first-child',this.source);this.$containers=$([]);var self=this,o=this.options;this.$tabs.each(function(i,a){if(a.hash&&a.hash.replace('#','')){self.$containers=self.$containers.add(a.hash)}else{var id=a.title&&a.title.replace(/\s/g,'_')||o.hashPrefix+(self.count+1)+'-'+(i+1),url=a.href;a.href='#'+id;a.url=url;self.$containers=self.$containers.add($('#'+id)[0]||$('<div id="'+id+'" class="'+o.containerClass+'"></div>').insertAfter(self.$containers[i-1]||self.source))}});if(init){this.$tabs.each(function(i,a){if(location.hash){if(a.hash==location.hash){o.initial=i;if($.browser.msie||$.browser.opera){var $toShow=$(location.hash),toShowId=$toShow.attr('id');$toShow.attr('id','');setTimeout(function(){$toShow.attr('id',toShowId)},500)};scrollTo(0,0);return false}}else if($(a).parents('li:eq(0)').is('li.'+o.selectedClass)){o.initial=i;return false}});$(this.source).is('.'+o.navClass)||$(this.source).addClass(o.navClass);this.$containers.each(function(){var $this=$(this);$this.is('.'+o.containerClass)||$this.addClass(o.containerClass)});var $lis=$('li',this.source);this.$containers.addClass(o.hideClass);$lis.removeClass(o.selectedClass);if(!o.unselected){this.$containers.slice(o.initial,o.initial+1).show();$lis.slice(o.initial,o.initial+1).addClass(o.selectedClass)};if(this.$tabs[o.initial].url){this.load(o.initial+1,this.$tabs[o.initial].url);if(o.cache)this.$tabs[o.initial].url=null};for(var i=0,position;position=o.disabled[i];i++)this.disable(position)};var showAnim={},hideAnim={},showSpeed=o.fxShowSpeed||o.fxSpeed,hideSpeed=o.fxHideSpeed||o.fxSpeed;if(o.fxSlide||o.fxFade){if(o.fxSlide){showAnim.height='show';hideAnim.height='hide'};if(o.fxFade){showAnim.opacity='show';hideAnim.opacity='hide'}}else{if(o.fxShow){showAnim=o.fxShow}else{showAnim['min-width']=0;showSpeed=1};if(o.fxHide){hideAnim=o.fxHide}else{hideAnim['min-width']=0;hideSpeed=1}};var click=o.click,hide=o.hide,show=o.show,resetCSS={display:'',overflow:'',height:''};if(!$.browser.msie)resetCSS.opacity=''
function hideTab(clicked,$hide,$show){$hide.animate(hideAnim,hideSpeed,function(){$hide.addClass(o.hideClass).css(resetCSS);hide(clicked,$show,$hide[0]);if($show)showTab(clicked,$hide,$show)})}
function showTab(clicked,$hide,$show){if(!(o.fxSlide||o.fxFade||o.fxShow))$show.css('display','block');$show.animate(showAnim,showSpeed,function(){$show.removeClass(o.hideClass).css(resetCSS);if($.browser.msie){$hide[0].style.filter='';$show[0].style.filter=''};show(clicked,$show[0],$hide[0]);self.animating=false})}
function switchTab(clicked,$hide,$show){$(clicked).parents('li:eq(0)').addClass(o.selectedClass).siblings().removeClass(o.selectedClass);hideTab(clicked,$hide,$show)}
function tabClick(e){var $li=$(this).parents('li:eq(0)'),$hide=self.$containers.filter(':visible'),$show=$(this.hash);if(o.toggle&&!$li.is('.'+o.disabledClass)&&!self.animating)if($li.is('.'+o.selectedClass)){$li.removeClass(o.selectedClass);hideTab(this,$hide);this.blur();return false}else if(!$hide.length){$li.addClass(o.selectedClass);showTab(this,$hide,$show);this.blur();return false};if($li.is('.'+o.selectedClass+', .'+o.disabledClass)||self.animating||click(this,$show[0],$hide[0])===false){this.blur();return false};self.animating=true;if($show.length){if(this.url){var a=this;self.load(self.$tabs.index(this)+1,this.url,function(){switchTab(a,$hide,$show)});if(o.cache)this.url=null}else switchTab(this,$hide,$show)}else throw Drupal.t('jQuery UI Tabs: Mismatching fragment identifier.');this.blur();return false};this.$tabs.unbind(o.event,tabClick).bind(o.event,tabClick)},add:function(url,text,position){if(url&&text){var o=this.options;position=position||this.$tabs.length;if(position>=this.$tabs.length){var method='insertAfter';position=this.$tabs.length}else var method='insertBefore';if(url.indexOf('#')==0){var $container=$(url);($container.length&&$container||$('<div id="'+url.replace('#','')+'" class="'+o.containerClass+' '+o.hideClass+'"></div>'))[method](this.$containers[position-1])};$('<li><a href="'+url+'"><span>'+text+'</span></a></li>')[method](this.$tabs.slice(position-1,position).parents('li:eq(0)'));this.tabify();o.add(this.$tabs[position-1],this.$containers[position-1])}else throw Drupal.t('jQuery UI Tabs: Not enough arguments to add tab.')},remove:function(position){if(position&&position.constructor==Number){this.$tabs.slice(position-1,position).parents('li:eq(0)').remove();this.$containers.slice(position-1,position).remove();this.tabify()};this.options.remove()},enable:function(position){var $li=this.$tabs.slice(position-1,position).parents('li:eq(0)'),o=this.options;$li.removeClass(o.disabledClass);if($.browser.safari)$li.animate({opacity:1},1,function(){$li.css({opacity:''})});o.enable(this.$tabs[position-1],this.$containers[position-1])},disable:function(position){var $li=this.$tabs.slice(position-1,position).parents('li:eq(0)'),o=this.options;if($.browser.safari)$li.animate({opacity:0},1,function(){$li.css({opacity:''})});$li.addClass(this.options.disabledClass);o.disable(this.$tabs[position-1],this.$containers[position-1])},click:function(position){this.$tabs.slice(position-1,position).trigger('click')},load:function(position,url,callback){var self=this,o=this.options,$a=this.$tabs.slice(position-1,position).addClass(o.loadingClass),$span=$('span',$a),text=$span.html();if(url&&url.constructor==Function)callback=url;if(url)$a[0].url=url;if(o.spinner)$span.html('<em>'+o.spinner+'</em>');setTimeout(function(){$($a[0].hash).load(url,function(){if(o.spinner)$span.html(text);$a.removeClass(o.loadingClass);if(callback&&callback.constructor==Function)callback();o.load(self.$tabs[position-1],self.$containers[position-1])})},0)}});
Drupal.Views.Ajax=Drupal.Views.Ajax||{};Drupal.Views.Ajax.setForm=function(title,output){$(Drupal.settings.views.ajax.title).html(title);$(Drupal.settings.views.ajax.id).html(output)};Drupal.Views.Ajax.ajaxResponse=function(data){$('a.views-throbbing').removeClass('views-throbbing');$('span.views-throbbing').remove();if(data.debug)alert(data.debug);if(Drupal.settings.viewsAjax)Drupal.settings.viewsAjax={};if(data.js)$.extend(Drupal.settings,data.js);if(data.display){Drupal.Views.Ajax.setForm(data.title,data.display);if(data.url){var ajax_area=Drupal.settings.views.ajax.id,ajax_title=Drupal.settings.views.ajax.title;$('input[type=submit], button',ajax_area).unbind('click');$('input[type=submit], button',ajax_area).click(function(){$('form',ajax_area).append('<input type="hidden" name="'+$(this).attr('name')+'" value="'+$(this).val()+'">');$(this).after('<span class="views-throbbing">&nbsp</span>')});$('form',ajax_area).unbind('submit');$('form',ajax_area).submit(function(arg){$(this).ajaxSubmit({url:data.url,data:{js:1},type:'POST',success:Drupal.Views.Ajax.ajaxResponse,error:function(xhr){$('span.views-throbbing').remove();Drupal.Views.Ajax.handleErrors(xhr,data.url)},dataType:'json'});return false})};Drupal.attachBehaviors(ajax_area)}else if(!data.tab){Drupal.Views.Ajax.setForm('',Drupal.settings.views.ajax.defaultForm);$('#edit-save').removeAttr('disabled');$('#edit-delete').removeAttr('disabled');if($('#views-ui-preview-form input#edit-live-preview').is(':checked'))$('#views-ui-preview-form').trigger('submit')};if(data.add)for(id in data.add){var newContent=$(id).append(data.add[id]);Drupal.attachBehaviors(newContent)};if(data.replace)for(id in data.replace){$(id).html(data.replace[id]);Drupal.attachBehaviors(id)};if(data.tab)for(id in data.tab){var instance=Drupal.Views.Tabs.instances[$('#views-tabset').data('UI_TABS_UUID')];instance.add(id,data.tab[id]['title'],0);instance.click(instance.$tabs.length);$(id).html(data.tab[id]['body']);$(id).addClass('views-tab');var display_id=id.replace('#views-tab-','');$("#preview-display-id").append('<option selected="selected" value="'+display_id+'">'+data.tab[id]['title']+'</option>');Drupal.attachBehaviors(id)};if(data.hilite){$('.hilited').removeClass('hilited');$(data.hilite).addClass('hilited')};if(data.changed)$('div.views-basic-info').addClass('changed')};Drupal.Views.Ajax.previewResponse=function(data){$('a.views-throbbing').removeClass('views-throbbing');$('span.views-throbbing').remove();if(data.debug)alert(data.debug);if(Drupal.settings.viewsAjax)Drupal.settings.viewsAjax={};if(data.js)$.extend(Drupal.settings,data.js);if(data.display){var ajax_area='div#views-live-preview';$(ajax_area).html(data.display);var url=$(ajax_area,'form').attr('action');if(url){$('input[type=submit], button',ajax_area).unbind('click');$('input[type=submit], button',ajax_area).click(function(){$('form',ajax_area).append('<input type="hidden" name="'+$(this).attr('name')+'" value="'+$(this).val()+'">');$(this).after('<span class="views-throbbing">&nbsp</span>')});$('form',ajax_area).unbind('submit');$('form',ajax_area).submit(function(){$(this).ajaxSubmit({url:url,data:{js:1},type:'POST',success:Drupal.Views.Ajax.previewResponse,error:function(xhr){$('span.views-throbbing').remove();Drupal.Views.Ajax.handleErrors(xhr,url)},dataType:'json'});return false})};Drupal.attachBehaviors(ajax_area)}};Drupal.Views.updatePreviewForm=function(){var url=$(this).attr('action');url=url.replace('nojs','ajax');$('input[type=submit], button',this).after('<span class="views-throbbing">&nbsp</span>');$(this).ajaxSubmit({url:url,data:{js:1},type:'POST',success:Drupal.Views.Ajax.previewResponse,error:function(xhr){$('span.views-throbbing').remove();Drupal.Views.Ajax.handleErrors(xhr,url)},dataType:'json'});return false};Drupal.Views.updatePreviewFilterForm=function(){var url=$(this).attr('action');url=url.replace('nojs','ajax');$('input[type=submit], button',this).after('<span class="views-throbbing">&nbsp</span>');$('input[name=q]',this).remove();$(this).ajaxSubmit({url:url,data:{js:1},type:'GET',success:Drupal.Views.Ajax.previewResponse,error:function(xhr){$('span.views-throbbing').remove();Drupal.Views.Ajax.handleErrors(xhr,url)},dataType:'json'});return false};Drupal.Views.updatePreviewLink=function(){var url=$(this).attr('href');url=url.replace('nojs','ajax');var intern_url=Drupal.Views.getPath(url);if(intern_url.substring(0,17)!='admin/build/views')return true;$(this).addClass('views-throbbing');$.ajax({url:url,data:'js=1',type:'POST',success:Drupal.Views.Ajax.previewResponse,error:function(xhr){$(this).removeClass('views-throbbing');Drupal.Views.Ajax.handleErrors(xhr,url)},dataType:'json'});return false};Drupal.behaviors.ViewsAjaxLinks=function(){$('a.views-ajax-link:not(.views-processed)').addClass('views-processed').click(function(){var url=$(this).attr('href');url=url.replace('nojs','ajax');$(this).addClass('hilite');$('#edit-save').attr('disabled','true');$('#edit-delete').attr('disabled','true');$(this).addClass('views-throbbing');$.ajax({type:"POST",url:url,data:'js=1',success:Drupal.Views.Ajax.ajaxResponse,error:function(xhr){$(this).removeClass('views-throbbing');Drupal.Views.Ajax.handleErrors(xhr,url)},dataType:'json'});return false});$('form.views-ajax-form:not(.views-processed)').addClass('views-processed').submit(function(arg){var url=$(this).attr('action');url=url.replace('nojs','ajax');$(this).ajaxSubmit({url:url,data:{js:1},type:'POST',success:Drupal.Views.Ajax.ajaxResponse,error:function(xhr){$('span.views-throbbing').remove();Drupal.Views.Ajax.handleErrors(xhr,url)},dataType:'json'});return false});$('form#views-ui-preview-form:not(.views-processed)').addClass('views-processed').submit(Drupal.Views.updatePreviewForm);$('div#views-live-preview form:not(.views-processed)').addClass('views-processed').submit(Drupal.Views.updatePreviewFilterForm);$('div#views-live-preview a:not(.views-processed)').addClass('views-processed').click(Drupal.Views.updatePreviewLink)};Drupal.behaviors.syncPreviewDisplay=function(){$("#views-tabset a").click(function(){var href=$(this).attr('href'),display_id=href.substr(11);$("#views-live-preview #preview-display-id").val(display_id)})};Drupal.theme.tableDragChangedWarning=function(){return'<div></div>'};Drupal.Views.Ajax.handleErrors=function(xhr,path){var error_text='';if((xhr.status==500&&xhr.responseText)||xhr.status==200){error_text=xhr.responseText;error_text=error_text.replace("/&(lt|gt);/g",function(m,p){return(p=="lt")?"<":">"});error_text=error_text.replace(/<("[^"]*"|'[^']*'|[^'">])*>/gi,"");error_text=error_text.replace(/[\n]+\s+/g,"\n")}else if(xhr.status==500){error_text=xhr.status+': '+Drupal.t("Internal server error. Please see server or PHP logs for error information.")}else error_text=xhr.status+': '+xhr.statusText;alert(Drupal.t("An error occurred at @path.\n\nError Description: @error",{'@path':path,'@error':error_text}))};
Drupal.toggleFieldset=function(fieldset){if($(fieldset).is('.collapsed')){var content=$('> div:not(.action)',fieldset);$(fieldset).removeClass('collapsed');content.hide();content.slideDown({duration:'fast',easing:'linear',complete:function(){Drupal.collapseScrollIntoView(this.parentNode);this.parentNode.animating=false;$('div.action',fieldset).show()},step:function(){Drupal.collapseScrollIntoView(this.parentNode)}})}else{$('div.action',fieldset).hide();var content=$('> div:not(.action)',fieldset).slideUp('fast',function(){$(this.parentNode).addClass('collapsed');this.parentNode.animating=false})}};Drupal.collapseScrollIntoView=function(node){var h=self.innerHeight||document.documentElement.clientHeight||$('body')[0].clientHeight||0,offset=self.pageYOffset||document.documentElement.scrollTop||$('body')[0].scrollTop||0,posY=$(node).offset().top,fudge=55;if(posY+node.offsetHeight+fudge>h+offset)if(node.offsetHeight>h){window.scrollTo(0,posY)}else window.scrollTo(0,posY+node.offsetHeight-h+fudge)};Drupal.behaviors.collapse=function(context){$('fieldset.collapsible > legend:not(.collapse-processed)',context).each(function(){var fieldset=$(this.parentNode);if($('input.error, textarea.error, select.error',fieldset).size()>0)fieldset.removeClass('collapsed');var text=this.innerHTML;$(this).empty().append($('<a href="#">'+text+'</a>').click(function(){var fieldset=$(this).parents('fieldset:first')[0];if(!fieldset.animating){fieldset.animating=true;Drupal.toggleFieldset(fieldset)};return false})).after($('<div class="fieldset-wrapper"></div>').append(fieldset.children(':not(legend):not(.action)'))).addClass('collapse-processed')})};
